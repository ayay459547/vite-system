import{p as ne,s as oe,b as ae}from"./vendor-js-binary-schema-parser.v2025-11-12.1.production.2025-11-14_09.15.33.js";import{c as se,P as le,o as ce}from"./vendor-@vue/runtime-core.v2025-11-12.1.production.2025-11-14_09.15.33.js";const fe=(a,t)=>{const e=a.__vccOpts||a;for(const[r,i]of t)e[r]=i;return e};function Pt(a){return a===""?a:a==="true"||a=="1"}function ue(a,t){return new Promise((e,r)=>{var i=new XMLHttpRequest;i.responseType="blob",i.onload=function(){var n=new FileReader;n.onloadend=function(){e(n.result)},n.readAsArrayBuffer(i.response)},i.open("GET",a),i.send()})}function tt(a){if(typeof a!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(a))}function Ot(a,t){for(var e="",r=0,i=-1,n=0,o,s=0;s<=a.length;++s){if(s<a.length)o=a.charCodeAt(s);else{if(o===47)break;o=47}if(o===47){if(!(i===s-1||n===1))if(i!==s-1&&n===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){var l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",r=0):(e=e.slice(0,l),r=e.length-1-e.lastIndexOf("/")),i=s,n=0;continue}}else if(e.length===2||e.length===1){e="",r=0,i=s,n=0;continue}}t&&(e.length>0?e+="/..":e="..",r=2)}else e.length>0?e+="/"+a.slice(i+1,s):e=a.slice(i+1,s),r=s-i-1;i=s,n=0}else o===46&&n!==-1?++n:n=-1}return e}function he(a,t){var e=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return e?e===t.root?e+r:e+a+r:r}var ct={resolve:function(){for(var t="",e=!1,r,i=arguments.length-1;i>=-1&&!e;i--){var n;i>=0?n=arguments[i]:(r===void 0&&(r=process.cwd()),n=r),tt(n),n.length!==0&&(t=n+"/"+t,e=n.charCodeAt(0)===47)}return t=Ot(t,!e),e?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(t){if(tt(t),t.length===0)return".";var e=t.charCodeAt(0)===47,r=t.charCodeAt(t.length-1)===47;return t=Ot(t,!e),t.length===0&&!e&&(t="."),t.length>0&&r&&(t+="/"),e?"/"+t:t},isAbsolute:function(t){return tt(t),t.length>0&&t.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var t,e=0;e<arguments.length;++e){var r=arguments[e];tt(r),r.length>0&&(t===void 0?t=r:t+="/"+r)}return t===void 0?".":ct.normalize(t)},relative:function(t,e){if(tt(t),tt(e),t===e||(t=ct.resolve(t),e=ct.resolve(e),t===e))return"";for(var r=1;r<t.length&&t.charCodeAt(r)===47;++r);for(var i=t.length,n=i-r,o=1;o<e.length&&e.charCodeAt(o)===47;++o);for(var s=e.length,l=s-o,c=n<l?n:l,u=-1,h=0;h<=c;++h){if(h===c){if(l>c){if(e.charCodeAt(o+h)===47)return e.slice(o+h+1);if(h===0)return e.slice(o+h)}else n>c&&(t.charCodeAt(r+h)===47?u=h:h===0&&(u=0));break}var b=t.charCodeAt(r+h),x=e.charCodeAt(o+h);if(b!==x)break;b===47&&(u=h)}var T="";for(h=r+u+1;h<=i;++h)(h===i||t.charCodeAt(h)===47)&&(T.length===0?T+="..":T+="/..");return T.length>0?T+e.slice(o+u):(o+=u,e.charCodeAt(o)===47&&++o,e.slice(o))},_makeLong:function(t){return t},dirname:function(t){if(tt(t),t.length===0)return".";for(var e=t.charCodeAt(0),r=e===47,i=-1,n=!0,o=t.length-1;o>=1;--o)if(e=t.charCodeAt(o),e===47){if(!n){i=o;break}}else n=!1;return i===-1?r?"/":".":r&&i===1?"//":t.slice(0,i)},basename:function(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');tt(t);var r=0,i=-1,n=!0,o;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";var s=e.length-1,l=-1;for(o=t.length-1;o>=0;--o){var c=t.charCodeAt(o);if(c===47){if(!n){r=o+1;break}}else l===-1&&(n=!1,l=o+1),s>=0&&(c===e.charCodeAt(s)?--s===-1&&(i=o):(s=-1,i=l))}return r===i?i=l:i===-1&&(i=t.length),t.slice(r,i)}else{for(o=t.length-1;o>=0;--o)if(t.charCodeAt(o)===47){if(!n){r=o+1;break}}else i===-1&&(n=!1,i=o+1);return i===-1?"":t.slice(r,i)}},extname:function(t){tt(t);for(var e=-1,r=0,i=-1,n=!0,o=0,s=t.length-1;s>=0;--s){var l=t.charCodeAt(s);if(l===47){if(!n){r=s+1;break}continue}i===-1&&(n=!1,i=s+1),l===46?e===-1?e=s:o!==1&&(o=1):e!==-1&&(o=-1)}return e===-1||i===-1||o===0||o===1&&e===i-1&&e===r+1?"":t.slice(e,i)},format:function(t){if(t===null||typeof t!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof t);return he("/",t)},parse:function(t){tt(t);var e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;var r=t.charCodeAt(0),i=r===47,n;i?(e.root="/",n=1):n=0;for(var o=-1,s=0,l=-1,c=!0,u=t.length-1,h=0;u>=n;--u){if(r=t.charCodeAt(u),r===47){if(!c){s=u+1;break}continue}l===-1&&(c=!1,l=u+1),r===46?o===-1?o=u:h!==1&&(h=1):o!==-1&&(h=-1)}return o===-1||l===-1||h===0||h===1&&o===l-1&&o===s+1?l!==-1&&(s===0&&i?e.base=e.name=t.slice(1,l):e.base=e.name=t.slice(s,l)):(s===0&&i?(e.name=t.slice(1,o),e.base=t.slice(1,l)):(e.name=t.slice(s,o),e.base=t.slice(s,l)),e.ext=t.slice(o,l)),s>0?e.dir=t.slice(0,s-1):i&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};ct.posix=ct;const ge=ct.extname,Zt=ct.basename;class de{constructor(){let t=typeof global>"u",e="image/png",r="image/jpeg",i="image/jpeg",n="image/webp",o="application/pdf",s="image/svg+xml";Object.assign(this,{toMime:this.toMime.bind(this),fromMime:this.fromMime.bind(this),expected:t?'"png", "jpg", or "webp"':'"png", "jpg", "pdf", or "svg"',formats:t?{png:e,jpg:r,jpeg:i,webp:n}:{png:e,jpg:r,jpeg:i,pdf:o,svg:s},mimes:t?{[e]:"png",[r]:"jpg",[n]:"webp"}:{[e]:"png",[r]:"jpg",[o]:"pdf",[s]:"svg"}})}toMime(t){return this.formats[(t||"").replace(/^\./,"").toLowerCase()]}fromMime(t){return this.mimes[t]}}function pe(a,{filename:t="",extension:e="",format:E,page:i,quality:n,matte:o,density:s,outline:l,archive:x}={}){var{fromMime:u,toMime:h,expected:b}=new de,x=x||"canvas",T=E||e.replace(/@\d+x$/i,"")||ge(t),E=u(h(T)||T),G=h(E),d=a.length;if(!T)throw new Error("Cannot determine image format (use a filename extension or 'format' argument)");if(!E)throw new Error(`Unsupported file format "${T}" (expected ${b})`);if(!d)throw new RangeError("Canvas has no associated contexts (try calling getContext or newPage first)");let p,P,g=t.replace(/{(\d*)}/g,(m,y)=>(P=!0,y=parseInt(y,10),p=isFinite(y)?y:isFinite(p)?p:-1,"{}")),w=i>0?i-1:i<0?d+i:void 0;if(isFinite(w)&&w<0||w>=d)throw new RangeError(d==1?`Canvas only has a ‘page 1’ (${w} is out of bounds)`:`Canvas has pages 1–${d} (${w} is out of bounds)`);if(a=isFinite(w)?[a[w]]:P||E=="pdf"?a:a.slice(-1),n===void 0)n=.92;else if(typeof n!="number"||!isFinite(n)||n<0||n>1)throw new TypeError("The quality option must be an number in the 0.0–1.0 range");if(s===void 0){let m=(e||Zt(t,T)).match(/@(\d+)x$/i);s=m?parseInt(m[1],10):1}else if(typeof s!="number"||!Number.isInteger(s)||s<1)throw new TypeError("The density option must be a non-negative integer");return l===void 0?l=!0:E=="svg"&&(l=!!l),{filename:t,pattern:g,format:E,mime:G,pages:a,padding:p,quality:n,matte:o,density:s,outline:l,archive:x}}class wt{static for(t){return new wt().append(t).get()}constructor(){this.crc=-1}get(){return~this.crc}append(t){for(var e=this.crc|0,r=this.table,i=0,n=t.length|0;i<n;i++)e=e>>>8^r[(e^t[i])&255];return this.crc=e,this}}wt.prototype.table=(()=>{var a,t,e,r=[];for(a=0;a<256;a++){for(e=a,t=0;t<8;t++)e=e&1?e>>>1^3988292384:e>>>1;r[a]=e}return r})();function At(a){let t=new Uint8Array(a),e=new DataView(t.buffer),r={array:t,view:e,size:a,set8(i,n){return e.setUint8(i,n),r},set16(i,n){return e.setUint16(i,n,!0),r},set32(i,n){return e.setUint32(i,n,!0),r},bytes(i,n){return t.set(n,i),r}};return r}class yt{constructor(t){let e=new Date;Object.assign(this,{directory:t,offset:0,files:[],time:(e.getHours()<<6|e.getMinutes())<<5|e.getSeconds()/2,date:(e.getFullYear()-1980<<4|e.getMonth()+1)<<5|e.getDate()}),this.add(t)}async add(t,e){let r=!e,i=yt.encoder.encode(`${this.directory}/${r?"":t}`),n=new Uint8Array(r?0:await e.arrayBuffer()),o=30+i.length,s=o+n.length,l=16,{offset:c}=this,u=At(26).set32(0,134742036).set16(6,this.time).set16(8,this.date).set32(10,wt.for(n)).set32(14,n.length).set32(18,n.length).set16(22,i.length);c+=o;let h=At(o+n.length+l).set32(0,67324752).bytes(4,u.array).bytes(30,i).bytes(o,n);c+=n.length,h.set32(s,134695760).bytes(s+4,u.array.slice(10,22)),c+=l,this.files.push({offset:c,folder:r,name:i,header:u,payload:h}),this.offset=c}toBuffer(){let t=this.files.reduce((h,{name:b})=>46+b.length+h,0),e=At(t+22),r=0;for(var{offset:i,name:n,header:o,folder:s}of this.files)e.set32(r,33639248).set16(r+4,20).bytes(r+6,o.array).set8(r+38,s?16:0).set32(r+42,i).bytes(r+46,n),r+=46+n.length;e.set32(r,101010256).set16(r+8,this.files.length).set16(r+10,this.files.length).set32(r+12,t).set32(r+16,this.offset);let l=new Uint8Array(this.offset+e.size),c=0;for(var{payload:u}of this.files)l.set(u.array,c),c+=u.size;return l.set(e.array,c),l}get blob(){return new Blob([this.toBuffer()],{type:"application/zip"})}}yt.encoder=new TextEncoder;const kt=(a,t,e,r)=>{if(r){let{width:i,height:n}=a,o=Object.assign(document.createElement("canvas"),{width:i,height:n}),s=o.getContext("2d");s.fillStyle=r,s.fillRect(0,0,i,n),s.drawImage(a,0,0),a=o}return new Promise((i,n)=>a.toBlob(i,t,e))},me=(...a)=>kt(...a).then(t=>t.arrayBuffer()),ve=async(a,t,e,r,i)=>{Jt(i,await kt(a,t,e,r))},be=async(a,t,e,r,i,n,o)=>{let s=u=>n.replace("{}",String(u+1).padStart(o,"0")),l=Zt(i,".zip")||"archive",c=new yt(l);await Promise.all(a.map(async(u,h)=>{let b=s(h);await c.add(b,await kt(u,t,e,r))})),Jt(`${l}.zip`,c.blob)},Jt=(a,t)=>{const e=window.URL.createObjectURL(t),r=document.createElement("a");r.style.display="none",r.href=e,r.setAttribute("download",a),typeof r.download>"u"&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>window.URL.revokeObjectURL(e),100)},we=(a,t,e)=>a.map(r=>{if(t==1&&!e)return r.canvas;let i=document.createElement("canvas"),n=i.getContext("2d"),o=r.canvas?r.canvas:r;return i.width=o.width*t,i.height=o.height*t,e&&(n.fillStyle=e,n.fillRect(0,0,i.width,i.height)),n.scale(t,t),n.drawImage(o,0,0),i}),ye={asBuffer:me,asDownload:ve,asZipDownload:be,atScale:we,options:pe},{asBuffer:Bt,asDownload:Ce,asZipDownload:xe,atScale:Dt,options:Tt}=ye,Rt=Symbol.for("toDataURL");let Pe=class{constructor(t,e){let r=document.createElement("canvas"),i=[];Object.defineProperty(r,"async",{value:!0,writable:!1,enumerable:!0});for(var[n,o]of Object.entries({png:()=>Bt(r,"image/png"),jpg:()=>Bt(r,"image/jpeg"),pages:()=>i.concat(r).map(s=>s.getContext("2d"))}))Object.defineProperty(r,n,{get:o});return Object.assign(r,{width:t,height:e,newPage(...s){var{width:c,height:u}=r,l=Object.assign(document.createElement("canvas"),{width:c,height:u});l.getContext("2d").drawImage(r,0,0),i.push(l);var[c,u]=s.length?s:[c,u];return Object.assign(r,{width:c,height:u}).getContext("2d")},saveAs(s,l){l=typeof l=="number"?{quality:l}:l;let c=Tt(this.pages,{filename:s,...l}),{pattern:u,padding:h,mime:b,quality:x,matte:T,density:E,archive:G}=c,d=Dt(c.pages,E);return h==null?Ce(d[0],b,x,T,s):xe(d,b,x,T,G,u,h)},toBuffer(s="png",l={}){l=typeof l=="number"?{quality:l}:l;let c=Tt(this.pages,{extension:s,...l}),{mime:u,quality:h,matte:b,pages:x,density:T}=c,E=Dt(x,T,b)[0];return Bt(E,u,h,b)},[Rt]:r.toDataURL.bind(r),toDataURL(s="png",l={}){l=typeof l=="number"?{quality:l}:l;let c=Tt(this.pages,{extension:s,...l}),{mime:u,quality:h,matte:b,pages:x,density:T}=c,E=Dt(x,T,b)[0],G=E[E===r?Rt:"toDataURL"](u,h);return Promise.resolve(G)}})}};const Ae={Canvas:Pe},Be=(a,t)=>{const e=new Array(a.length),r=a.length/t,i=function(u,h){const b=a.slice(h*t,(h+1)*t);e.splice.apply(e,[u*t,t].concat(b))},n=[0,4,2,1],o=[8,8,4,2];for(var s=0,l=0;l<4;l++)for(var c=n[l];c<r;c+=o[l])i(c,s),s++;return e},De=(a,t,e)=>{const n=e;var o,s,l,c,u,h,b,w,x,T,g,E,m,y,k,A;const G=new Array(e),d=new Array(4096),p=new Array(4096),P=new Array(4097);for(E=a,s=1<<E,u=s+1,o=s+2,b=-1,c=E+1,l=(1<<c)-1,x=0;x<s;x++)d[x]=0,p[x]=x;var g,w,m,y,A,k;for(g=w=m=y=A=k=0,T=0;T<n;){if(y===0){if(w<c){g+=t[k]<<w,w+=8,k++;continue}if(x=g&l,g>>=c,w-=c,x>o||x==u)break;if(x==s){c=E+1,l=(1<<c)-1,o=s+2,b=-1;continue}if(b==-1){P[y++]=p[x],b=x,m=x;continue}for(h=x,x==o&&(P[y++]=m,x=b);x>s;)P[y++]=p[x],x=d[x];m=p[x]&255,P[y++]=m,o<4096&&(d[o]=b,p[o]=m,o++,(o&l)===0&&o<4096&&(c++,l+=o)),b=h}y--,G[A++]=P[y],T++}for(T=A;T<n;T++)G[T]=0;return G},Te=a=>{const t=new Uint8Array(a);return ne(ae(t),oe)},Ee=a=>{const t=a.pixels.length,e=new Uint8ClampedArray(t*4);for(var r=0;r<t;r++){const i=r*4,n=a.pixels[r],o=a.colorTable[n];e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2],e[i+3]=n!==a.transparentIndex?255:0}return e},ke=(a,t,e)=>{if(!a.image){console.warn("gif frame does not have associated image.");return}const{image:r}=a,i=r.descriptor.width*r.descriptor.height;var n=De(r.data.minCodeSize,r.data.blocks,i);r.descriptor.lct.interlaced&&(n=Be(n,r.descriptor.width));const o={pixels:n,dims:{top:a.image.descriptor.top,left:a.image.descriptor.left,width:a.image.descriptor.width,height:a.image.descriptor.height}};return r.descriptor.lct&&r.descriptor.lct.exists?o.colorTable=r.lct:o.colorTable=t,a.gce&&(o.delay=(a.gce.delay||10)*10,o.disposalType=a.gce.extras.disposal,a.gce.extras.transparentColorGiven&&(o.transparentIndex=a.gce.transparentColorIndex)),o.patch=Ee(o),o},Se=(a,t)=>a.frames.filter(e=>e.image).map(e=>ke(e,a.gct));function Ie(a,t,e){const r=Vt(t),i=a-1;let n=0;switch(e){case Z.L:n=et[i][0];break;case Z.M:n=et[i][1];break;case Z.Q:n=et[i][2];break;case Z.H:n=et[i][3];break}return r<=n}function Le(a,t){for(var e=1,r=Vt(a),i=0,n=et.length;i<n;i++){var o=0;switch(t){case Z.L:o=et[i][0];break;case Z.M:o=et[i][1];break;case Z.Q:o=et[i][2];break;case Z.H:o=et[i][3];break}if(r<=o)break;e++}if(e>et.length)throw new Error("Too long data");return e}function Vt(a){var t=encodeURI(a).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=Number(a)?3:0)}class _e{constructor(t){this.mode=V.MODE_8BIT_BYTE,this.parsedData=[],this.data=t;const e=[];for(let r=0,i=this.data.length;r<i;r++){const n=[],o=this.data.charCodeAt(r);o>65536?(n[0]=240|(o&1835008)>>>18,n[1]=128|(o&258048)>>>12,n[2]=128|(o&4032)>>>6,n[3]=128|o&63):o>2048?(n[0]=224|(o&61440)>>>12,n[1]=128|(o&4032)>>>6,n[2]=128|o&63):o>128?(n[0]=192|(o&1984)>>>6,n[1]=128|o&63):n[0]=o,e.push(n)}this.parsedData=Array.prototype.concat.apply([],e),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}getLength(){return this.parsedData.length}write(t){for(let e=0,r=this.parsedData.length;e<r;e++)t.put(this.parsedData[e],8)}}class st{constructor(t=-1,e=Z.L){this.moduleCount=0,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.moduleCount=0,this.dataList=[]}addData(t){if(this.typeNumber<=0)this.typeNumber=Le(t,this.errorCorrectLevel);else{if(this.typeNumber>40)throw new Error(`Invalid QR version: ${this.typeNumber}`);if(!Ie(this.typeNumber,t,this.errorCorrectLevel))throw new Error(`Data is too long for QR version: ${this.typeNumber}`)}const e=new _e(t);this.dataList.push(e),this.dataCache=void 0}isDark(t,e){if(t<0||this.moduleCount<=t||e<0||this.moduleCount<=e)throw new Error(`${t},${e}`);return this.modules[t][e]}getModuleCount(){return this.moduleCount}make(){this.makeImpl(!1,this.getBestMaskPattern())}makeImpl(t,e){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(let r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(let i=0;i<this.moduleCount;i++)this.modules[r][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),this.dataCache==null&&(this.dataCache=st.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)}setupPositionProbePattern(t,e){for(let r=-1;r<=7;r++)if(!(t+r<=-1||this.moduleCount<=t+r))for(let i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(0<=r&&r<=6&&(i==0||i==6)||0<=i&&i<=6&&(r==0||r==6)||2<=r&&r<=4&&2<=i&&i<=4?this.modules[t+r][e+i]=!0:this.modules[t+r][e+i]=!1)}getBestMaskPattern(){if(Number.isInteger(this.maskPattern)&&Object.values(it).includes(this.maskPattern))return this.maskPattern;let t=0,e=0;for(let r=0;r<8;r++){this.makeImpl(!0,r);const i=_.getLostPoint(this);(r==0||t>i)&&(t=i,e=r)}return e}setupTimingPattern(){for(let t=8;t<this.moduleCount-8;t++)this.modules[t][6]==null&&(this.modules[t][6]=t%2==0);for(let t=8;t<this.moduleCount-8;t++)this.modules[6][t]==null&&(this.modules[6][t]=t%2==0)}setupPositionAdjustPattern(){const t=_.getPatternPosition(this.typeNumber);for(let e=0;e<t.length;e++)for(let r=0;r<t.length;r++){const i=t[e],n=t[r];if(this.modules[i][n]==null)for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++)o==-2||o==2||s==-2||s==2||o==0&&s==0?this.modules[i+o][n+s]=!0:this.modules[i+o][n+s]=!1}}setupTypeNumber(t){const e=_.getBCHTypeNumber(this.typeNumber);for(var r=0;r<18;r++){var i=!t&&(e>>r&1)==1;this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=i}for(var r=0;r<18;r++){var i=!t&&(e>>r&1)==1;this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=i}}setupTypeInfo(t,e){const r=this.errorCorrectLevel<<3|e,i=_.getBCHTypeInfo(r);for(var n=0;n<15;n++){var o=!t&&(i>>n&1)==1;n<6?this.modules[n][8]=o:n<8?this.modules[n+1][8]=o:this.modules[this.moduleCount-15+n][8]=o}for(var n=0;n<15;n++){var o=!t&&(i>>n&1)==1;n<8?this.modules[8][this.moduleCount-n-1]=o:n<9?this.modules[8][15-n-1+1]=o:this.modules[8][15-n-1]=o}this.modules[this.moduleCount-8][8]=!t}mapData(t,e){let r=-1,i=this.moduleCount-1,n=7,o=0;for(let s=this.moduleCount-1;s>0;s-=2)for(s==6&&s--;;){for(let l=0;l<2;l++)if(this.modules[i][s-l]==null){let c=!1;o<t.length&&(c=(t[o]>>>n&1)==1),_.getMask(e,i,s-l)&&(c=!c),this.modules[i][s-l]=c,n--,n==-1&&(o++,n=7)}if(i+=r,i<0||this.moduleCount<=i){i-=r,r=-r;break}}}static createData(t,e,r){const i=nt.getRSBlocks(t,e),n=new Me;for(var o=0;o<r.length;o++){const l=r[o];n.put(l.mode,4),n.put(l.getLength(),_.getLengthInBits(l.mode,t)),l.write(n)}let s=0;for(var o=0;o<i.length;o++)s+=i[o].dataCount;if(n.getLengthInBits()>s*8)throw new Error(`code length overflow. (${n.getLengthInBits()}>${s*8})`);for(n.getLengthInBits()+4<=s*8&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(!1);for(;!(n.getLengthInBits()>=s*8||(n.put(st.PAD0,8),n.getLengthInBits()>=s*8));)n.put(st.PAD1,8);return st.createBytes(n,i)}static createBytes(t,e){let r=0,i=0,n=0;const o=new Array(e.length),s=new Array(e.length);for(var l=0;l<e.length;l++){const x=e[l].dataCount,T=e[l].totalCount-x;i=Math.max(i,x),n=Math.max(n,T),o[l]=new Array(x);for(var c=0;c<o[l].length;c++)o[l][c]=255&t.buffer[c+r];r+=x;const E=_.getErrorCorrectPolynomial(T),d=new ut(o[l],E.getLength()-1).mod(E);s[l]=new Array(E.getLength()-1);for(var c=0;c<s[l].length;c++){const P=c+d.getLength()-s[l].length;s[l][c]=P>=0?d.get(P):0}}let u=0;for(var c=0;c<e.length;c++)u+=e[c].totalCount;const h=new Array(u);let b=0;for(var c=0;c<i;c++)for(var l=0;l<e.length;l++)c<o[l].length&&(h[b++]=o[l][c]);for(var c=0;c<n;c++)for(var l=0;l<e.length;l++)c<s[l].length&&(h[b++]=s[l][c]);return h}}st.PAD0=236;st.PAD1=17;const Z={L:1,M:0,Q:3,H:2},V={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},it={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};class _{static getBCHTypeInfo(t){let e=t<<10;for(;_.getBCHDigit(e)-_.getBCHDigit(_.G15)>=0;)e^=_.G15<<_.getBCHDigit(e)-_.getBCHDigit(_.G15);return(t<<10|e)^_.G15_MASK}static getBCHTypeNumber(t){let e=t<<12;for(;_.getBCHDigit(e)-_.getBCHDigit(_.G18)>=0;)e^=_.G18<<_.getBCHDigit(e)-_.getBCHDigit(_.G18);return t<<12|e}static getBCHDigit(t){let e=0;for(;t!=0;)e++,t>>>=1;return e}static getPatternPosition(t){return _.PATTERN_POSITION_TABLE[t-1]}static getMask(t,e,r){switch(t){case it.PATTERN000:return(e+r)%2==0;case it.PATTERN001:return e%2==0;case it.PATTERN010:return r%3==0;case it.PATTERN011:return(e+r)%3==0;case it.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case it.PATTERN101:return e*r%2+e*r%3==0;case it.PATTERN110:return(e*r%2+e*r%3)%2==0;case it.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error(`bad maskPattern:${t}`)}}static getErrorCorrectPolynomial(t){let e=new ut([1],0);for(let r=0;r<t;r++)e=e.multiply(new ut([1,U.gexp(r)],0));return e}static getLengthInBits(t,e){if(1<=e&&e<10)switch(t){case V.MODE_NUMBER:return 10;case V.MODE_ALPHA_NUM:return 9;case V.MODE_8BIT_BYTE:return 8;case V.MODE_KANJI:return 8;default:throw new Error(`mode:${t}`)}else if(e<27)switch(t){case V.MODE_NUMBER:return 12;case V.MODE_ALPHA_NUM:return 11;case V.MODE_8BIT_BYTE:return 16;case V.MODE_KANJI:return 10;default:throw new Error(`mode:${t}`)}else if(e<41)switch(t){case V.MODE_NUMBER:return 14;case V.MODE_ALPHA_NUM:return 13;case V.MODE_8BIT_BYTE:return 16;case V.MODE_KANJI:return 12;default:throw new Error(`mode:${t}`)}else throw new Error(`type:${e}`)}static getLostPoint(t){const e=t.getModuleCount();let r=0;for(var i=0;i<e;i++)for(var n=0;n<e;n++){let l=0;const c=t.isDark(i,n);for(let u=-1;u<=1;u++)if(!(i+u<0||e<=i+u))for(let h=-1;h<=1;h++)n+h<0||e<=n+h||u==0&&h==0||c==t.isDark(i+u,n+h)&&l++;l>5&&(r+=3+l-5)}for(var i=0;i<e-1;i++)for(var n=0;n<e-1;n++){let u=0;t.isDark(i,n)&&u++,t.isDark(i+1,n)&&u++,t.isDark(i,n+1)&&u++,t.isDark(i+1,n+1)&&u++,(u==0||u==4)&&(r+=3)}for(var i=0;i<e;i++)for(var n=0;n<e-6;n++)t.isDark(i,n)&&!t.isDark(i,n+1)&&t.isDark(i,n+2)&&t.isDark(i,n+3)&&t.isDark(i,n+4)&&!t.isDark(i,n+5)&&t.isDark(i,n+6)&&(r+=40);for(var n=0;n<e;n++)for(var i=0;i<e-6;i++)t.isDark(i,n)&&!t.isDark(i+1,n)&&t.isDark(i+2,n)&&t.isDark(i+3,n)&&t.isDark(i+4,n)&&!t.isDark(i+5,n)&&t.isDark(i+6,n)&&(r+=40);let o=0;for(var n=0;n<e;n++)for(var i=0;i<e;i++)t.isDark(i,n)&&o++;const s=Math.abs(100*o/e/e-50)/5;return r+=s*10,r}}_.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]];_.G15=1335;_.G18=7973;_.G15_MASK=21522;class U{static glog(t){if(t<1)throw new Error(`glog(${t})`);return U.LOG_TABLE[t]}static gexp(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return U.EXP_TABLE[t]}}U.EXP_TABLE=new Array(256);U.LOG_TABLE=new Array(256);U._constructor=(function(){for(var a=0;a<8;a++)U.EXP_TABLE[a]=1<<a;for(var a=8;a<256;a++)U.EXP_TABLE[a]=U.EXP_TABLE[a-4]^U.EXP_TABLE[a-5]^U.EXP_TABLE[a-6]^U.EXP_TABLE[a-8];for(var a=0;a<255;a++)U.LOG_TABLE[U.EXP_TABLE[a]]=a})();class ut{constructor(t,e){if(t.length==null)throw new Error(`${t.length}/${e}`);let r=0;for(;r<t.length&&t[r]==0;)r++;this.num=new Array(t.length-r+e);for(let i=0;i<t.length-r;i++)this.num[i]=t[i+r]}get(t){return this.num[t]}getLength(){return this.num.length}multiply(t){const e=new Array(this.getLength()+t.getLength()-1);for(let r=0;r<this.getLength();r++)for(let i=0;i<t.getLength();i++)e[r+i]^=U.gexp(U.glog(this.get(r))+U.glog(t.get(i)));return new ut(e,0)}mod(t){if(this.getLength()-t.getLength()<0)return this;const e=U.glog(this.get(0))-U.glog(t.get(0)),r=new Array(this.getLength());for(var i=0;i<this.getLength();i++)r[i]=this.get(i);for(var i=0;i<t.getLength();i++)r[i]^=U.gexp(U.glog(t.get(i))+e);return new ut(r,0).mod(t)}}class nt{constructor(t,e){this.totalCount=t,this.dataCount=e}static getRSBlocks(t,e){const r=nt.getRsBlockTable(t,e);if(r==null)throw new Error(`bad rs block @ typeNumber:${t}/errorCorrectLevel:${e}`);const i=r.length/3,n=[];for(let o=0;o<i;o++){const s=r[o*3+0],l=r[o*3+1],c=r[o*3+2];for(let u=0;u<s;u++)n.push(new nt(l,c))}return n}static getRsBlockTable(t,e){switch(e){case Z.L:return nt.RS_BLOCK_TABLE[(t-1)*4+0];case Z.M:return nt.RS_BLOCK_TABLE[(t-1)*4+1];case Z.Q:return nt.RS_BLOCK_TABLE[(t-1)*4+2];case Z.H:return nt.RS_BLOCK_TABLE[(t-1)*4+3];default:return}}}nt.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];class Me{constructor(){this.buffer=[],this.length=0}get(t){const e=Math.floor(t/8);return(this.buffer[e]>>>7-t%8&1)==1}put(t,e){for(let r=0;r<e;r++)this.putBit((t>>>e-r-1&1)==1)}getLengthInBits(){return this.length}putBit(t){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}}const et=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];var Fe=100,K=256,$t=K-1,at=4,Wt=16,St=1<<Wt,Yt=10,It=10,Ne=St>>It,Oe=St<<Yt-It,Re=K>>3,Et=6,$e=1<<Et,Ge=Re*$e,je=30,qt=10,pt=1<<qt,Qt=8,Gt=1<<Qt,Ue=qt+Qt,ft=1<<Ue,jt=499,Ut=491,zt=487,te=503,ze=3*te;function He(a,t){var e,r,i,n,o;function s(){e=[],r=new Int32Array(256),i=new Int32Array(K),n=new Int32Array(K),o=new Int32Array(K>>3);var d,p;for(d=0;d<K;d++)p=(d<<at+8)/K,e[d]=new Float64Array([p,p,p,0]),n[d]=St/K,i[d]=0}function l(){for(var d=0;d<K;d++)e[d][0]>>=at,e[d][1]>>=at,e[d][2]>>=at,e[d][3]=d}function c(d,p,P,g,w){e[p][0]-=d*(e[p][0]-P)/pt,e[p][1]-=d*(e[p][1]-g)/pt,e[p][2]-=d*(e[p][2]-w)/pt}function u(d,p,P,g,w){for(var m=Math.abs(p-d),y=Math.min(p+d,K),A=p+1,k=p-1,M=1,f,F;A<y||k>m;)F=o[M++],A<y&&(f=e[A++],f[0]-=F*(f[0]-P)/ft,f[1]-=F*(f[1]-g)/ft,f[2]-=F*(f[2]-w)/ft),k>m&&(f=e[k--],f[0]-=F*(f[0]-P)/ft,f[1]-=F*(f[1]-g)/ft,f[2]-=F*(f[2]-w)/ft)}function h(d,p,P){var g=2147483647,w=g,m=-1,y=m,A,k,M,f,F;for(A=0;A<K;A++)k=e[A],M=Math.abs(k[0]-d)+Math.abs(k[1]-p)+Math.abs(k[2]-P),M<g&&(g=M,m=A),f=M-(i[A]>>Wt-at),f<w&&(w=f,y=A),F=n[A]>>It,n[A]-=F,i[A]+=F<<Yt;return n[m]+=Ne,i[m]-=Oe,y}function b(){var d,p,P,g,w,m,y=0,A=0;for(d=0;d<K;d++){for(P=e[d],w=d,m=P[1],p=d+1;p<K;p++)g=e[p],g[1]<m&&(w=p,m=g[1]);if(g=e[w],d!=w&&(p=g[0],g[0]=P[0],P[0]=p,p=g[1],g[1]=P[1],P[1]=p,p=g[2],g[2]=P[2],P[2]=p,p=g[3],g[3]=P[3],P[3]=p),m!=y){for(r[y]=A+d>>1,p=y+1;p<m;p++)r[p]=d;y=m,A=d}}for(r[y]=A+$t>>1,p=y+1;p<256;p++)r[p]=$t}function x(d,p,P){for(var g,w,m,y=1e3,A=-1,k=r[p],M=k-1;k<K||M>=0;)k<K&&(w=e[k],m=w[1]-p,m>=y?k=K:(k++,m<0&&(m=-m),g=w[0]-d,g<0&&(g=-g),m+=g,m<y&&(g=w[2]-P,g<0&&(g=-g),m+=g,m<y&&(y=m,A=w[3])))),M>=0&&(w=e[M],m=p-w[1],m>=y?M=-1:(M--,m<0&&(m=-m),g=w[0]-d,g<0&&(g=-g),m+=g,m<y&&(g=w[2]-P,g<0&&(g=-g),m+=g,m<y&&(y=m,A=w[3]))));return A}function T(){var d,p=a.length,P=30+(t-1)/3,g=p/(3*t),w=~~(g/Fe),m=pt,y=Ge,A=y>>Et;for(A<=1&&(A=0),d=0;d<A;d++)o[d]=m*((A*A-d*d)*Gt/(A*A));var k;p<ze?(t=1,k=3):p%jt!==0?k=3*jt:p%Ut!==0?k=3*Ut:p%zt!==0?k=3*zt:k=3*te;var M,f,F,C,N=0;for(d=0;d<g;)if(M=(a[N]&255)<<at,f=(a[N+1]&255)<<at,F=(a[N+2]&255)<<at,C=h(M,f,F),c(m,C,M,f,F),A!==0&&u(A,C,M,f,F),N+=k,N>=p&&(N-=p),d++,w===0&&(w=1),d%w===0)for(m-=m/P,y-=y/je,A=y>>Et,A<=1&&(A=0),C=0;C<A;C++)o[C]=m*((A*A-C*C)*Gt/(A*A))}function E(){s(),T(),l(),b()}this.buildColormap=E;function G(){for(var d=[],p=[],P=0;P<K;P++)p[e[P][3]]=P;for(var g=0,w=0;w<K;w++){var m=p[w];d[g++]=e[m][0],d[g++]=e[m][1],d[g++]=e[m][2]}return d}this.getColormap=G,this.lookupRGB=x}var Ht=-1,mt=12,gt=5003,Ke=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];function Xe(a,t,e,r){var i=Math.max(2,r),n=new Uint8Array(256),o=new Int32Array(gt),s=new Int32Array(gt),l,c=0,u,h=0,b,x=!1,T,E,G,d,p,P;function g(C,N){n[u++]=C,u>=254&&k(N)}function w(C){m(gt),h=E+2,x=!0,F(E,C)}function m(C){for(var N=0;N<C;++N)o[N]=-1}function y(C,N){var v,lt,j,Y,ot,z,q;for(T=C,x=!1,P=T,b=M(P),E=1<<C-1,G=E+1,h=E+2,u=0,Y=f(),q=0,v=gt;v<65536;v*=2)++q;q=8-q,z=gt,m(z),F(E,N);t:for(;(lt=f())!=Ht;){if(v=(lt<<mt)+Y,j=lt<<q^Y,o[j]===v){Y=s[j];continue}else if(o[j]>=0){ot=z-j,j===0&&(ot=1);do if((j-=ot)<0&&(j+=z),o[j]===v){Y=s[j];continue t}while(o[j]>=0)}F(Y,N),Y=lt,h<1<<mt?(s[j]=h++,o[j]=v):w(N)}F(Y,N),F(G,N)}function A(C){C.writeByte(i),d=a*t,p=0,y(i+1,C),C.writeByte(0)}function k(C){u>0&&(C.writeByte(u),C.writeBytes(n,0,u),u=0)}function M(C){return(1<<C)-1}function f(){if(d===0)return Ht;--d;var C=e[p++];return C&255}function F(C,N){for(l&=Ke[c],c>0?l|=C<<c:l=C,c+=P;c>=8;)g(l&255,N),l>>=8,c-=8;if((h>b||x)&&(x?(b=M(P=T),x=!1):(++P,P==mt?b=1<<mt:b=M(P))),C==G){for(;c>0;)g(l&255,N),l>>=8,c-=8;k(N)}}this.encode=A}function J(){this.page=-1,this.pages=[],this.newPage()}J.pageSize=4096;J.charMap={};for(var vt=0;vt<256;vt++)J.charMap[vt]=String.fromCharCode(vt);J.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(J.pageSize),this.cursor=0};J.prototype.getData=function(){for(var a="",t=0;t<this.pages.length;t++)for(var e=0;e<J.pageSize;e++)a+=J.charMap[this.pages[t][e]];return a};J.prototype.toFlattenUint8Array=function(){const a=[];for(var t=0;t<this.pages.length;t++)if(t===this.pages.length-1){const r=Uint8Array.from(this.pages[t].slice(0,this.cursor));a.push(r)}else a.push(this.pages[t]);const e=new Uint8Array(a.reduce((r,i)=>r+i.length,0));return a.reduce((r,i)=>(e.set(i,r),r+i.length),0),e};J.prototype.writeByte=function(a){this.cursor>=J.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=a};J.prototype.writeUTFBytes=function(a){for(var t=a.length,e=0;e<t;e++)this.writeByte(a.charCodeAt(e))};J.prototype.writeBytes=function(a,t,e){for(var r=e||a.length,i=t||0;i<r;i++)this.writeByte(a[i])};function O(a,t){this.width=~~a,this.height=~~t,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new J}O.prototype.setDelay=function(a){this.delay=Math.round(a/10)};O.prototype.setFrameRate=function(a){this.delay=Math.round(100/a)};O.prototype.setDispose=function(a){a>=0&&(this.dispose=a)};O.prototype.setRepeat=function(a){this.repeat=a};O.prototype.setTransparent=function(a){this.transparent=a};O.prototype.addFrame=function(a){this.image=a,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),this.globalPalette===!0&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeHeader(),this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),!this.firstFrame&&!this.globalPalette&&this.writePalette(),this.writePixels(),this.firstFrame=!1};O.prototype.finish=function(){this.out.writeByte(59)};O.prototype.setQuality=function(a){a<1&&(a=1),this.sample=a};O.prototype.setDither=function(a){a===!0&&(a="FloydSteinberg"),this.dither=a};O.prototype.setGlobalPalette=function(a){this.globalPalette=a};O.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette};O.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")};O.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new He(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),this.dither.match(/-serpentine/)!==null):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,this.transparent!==null&&(this.transIndex=this.findClosest(this.transparent,!0))};O.prototype.indexPixels=function(a){var t=this.pixels.length/3;this.indexedPixels=new Uint8Array(t);for(var e=0,r=0;r<t;r++){var i=this.findClosestRGB(this.pixels[e++]&255,this.pixels[e++]&255,this.pixels[e++]&255);this.usedEntry[i]=!0,this.indexedPixels[r]=i}};O.prototype.ditherPixels=function(a,t){var e={FalseFloydSteinberg:[[.375,1,0],[.375,0,1],[.25,1,1]],FloydSteinberg:[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],Stucki:[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],Atkinson:[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]};if(!a||!e[a])throw"Unknown dithering kernel: "+a;var r=e[a],i=0,n=this.height,o=this.width,s=this.pixels,l=t?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var c=0;c<n;c++){t&&(l=l*-1);for(var u=l==1?0:o-1,h=l==1?o:0;u!==h;u+=l){i=c*o+u;var b=i*3,x=s[b],T=s[b+1],E=s[b+2];b=this.findClosestRGB(x,T,E),this.usedEntry[b]=!0,this.indexedPixels[i]=b,b*=3;for(var G=this.colorTab[b],d=this.colorTab[b+1],p=this.colorTab[b+2],P=x-G,g=T-d,w=E-p,m=l==1?0:r.length-1,y=l==1?r.length:0;m!==y;m+=l){var A=r[m][1],k=r[m][2];if(A+u>=0&&A+u<o&&k+c>=0&&k+c<n){var M=r[m][0];b=i+A+k*o,b*=3,s[b]=Math.max(0,Math.min(255,s[b]+P*M)),s[b+1]=Math.max(0,Math.min(255,s[b+1]+g*M)),s[b+2]=Math.max(0,Math.min(255,s[b+2]+w*M))}}}}};O.prototype.findClosest=function(a,t){return this.findClosestRGB((a&16711680)>>16,(a&65280)>>8,a&255,t)};O.prototype.findClosestRGB=function(a,t,e,r){if(this.colorTab===null)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(a,t,e);for(var i=0,n=256*256*256,o=this.colorTab.length,s=0,l=0;s<o;l++){var c=a-(this.colorTab[s++]&255),u=t-(this.colorTab[s++]&255),h=e-(this.colorTab[s++]&255),b=c*c+u*u+h*h;(!r||this.usedEntry[l])&&b<n&&(n=b,i=l)}return i};O.prototype.getImagePixels=function(){var a=this.width,t=this.height;this.pixels=new Uint8Array(a*t*3);for(var e=this.image,r=0,i=0,n=0;n<t;n++)for(var o=0;o<a;o++)this.pixels[i++]=e[r++],this.pixels[i++]=e[r++],this.pixels[i++]=e[r++],r++};O.prototype.writeGraphicCtrlExt=function(){this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4);var a,t;this.transparent===null?(a=0,t=0):(a=1,t=2),this.dispose>=0&&(t=this.dispose&7),t<<=2,this.out.writeByte(0|t|0|a),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)};O.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)};O.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)};O.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)};O.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var a=3*256-this.colorTab.length,t=0;t<a;t++)this.out.writeByte(0)};O.prototype.writeShort=function(a){this.out.writeByte(a&255),this.out.writeByte(a>>8&255)};O.prototype.writePixels=function(){var a=new Xe(this.width,this.height,this.indexedPixels,this.colorDepth);a.encode(this.out)};O.prototype.stream=function(){return this.out};var Ze=function(a,t,e,r){function i(n){return n instanceof e?n:new e(function(o){o(n)})}return new(e||(e=Promise))(function(n,o){function s(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?n(u.value):i(u.value).then(s,l)}c((r=r.apply(a,t||[])).next())})};const{Canvas:rt}=Ae,bt=.4;function Kt(a){if(!a)return;function t(e){e.onload=null,e.onerror=null}return new Promise(function(e,r){if(a.slice(0,4)=="data"){let n=new Image;n.onload=function(){e(n),t(n)},n.onerror=function(){r("Image load error"),t(n)},n.src=a;return}let i=new Image;i.setAttribute("crossOrigin","Anonymous"),i.onload=function(){e(i)},i.onerror=function(){r("Image load error")},i.src=a})}class L{constructor(t){const e=Object.assign({},t);if(Object.keys(L.defaultOptions).forEach(r=>{r in e||Object.defineProperty(e,r,{value:L.defaultOptions[r],enumerable:!0,writable:!0})}),e.components?typeof e.components=="object"&&Object.keys(L.defaultComponentOptions).forEach(r=>{r in e.components?Object.defineProperty(e.components,r,{value:Object.assign(Object.assign({},L.defaultComponentOptions[r]),e.components[r]),enumerable:!0,writable:!0}):Object.defineProperty(e.components,r,{value:L.defaultComponentOptions[r],enumerable:!0,writable:!0})}):e.components=L.defaultComponentOptions,e.dotScale!==null&&e.dotScale!==void 0){if(e.dotScale<=0||e.dotScale>1)throw new Error("dotScale should be in range (0, 1].");e.components.data.scale=e.dotScale,e.components.timing.scale=e.dotScale,e.components.alignment.scale=e.dotScale}this.options=e,this.canvas=new rt(t.size,t.size),this.canvasContext=this.canvas.getContext("2d"),this.qrCode=new st(-1,this.options.correctLevel),Number.isInteger(this.options.maskPattern)&&(this.qrCode.maskPattern=this.options.maskPattern),Number.isInteger(this.options.version)&&(this.qrCode.typeNumber=this.options.version),this.qrCode.addData(this.options.text),this.qrCode.make()}draw(){return new Promise(t=>this._draw().then(t))}_clear(){this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height)}static _prepareRoundedCornerClip(t,e,r,i,n,o){t.beginPath(),t.moveTo(e,r),t.arcTo(e+i,r,e+i,r+n,o),t.arcTo(e+i,r+n,e,r+n,o),t.arcTo(e,r+n,e,r,o),t.arcTo(e,r,e+i,r,o),t.closePath()}static _getAverageRGB(t){const r={r:0,g:0,b:0};let i,n,o=-4;const s={r:0,g:0,b:0};let l=0;n=t.naturalHeight||t.height,i=t.naturalWidth||t.width;const u=new rt(i,n).getContext("2d");if(!u)return r;u.drawImage(t,0,0);let h;try{h=u.getImageData(0,0,i,n)}catch{return r}for(;(o+=20)<h.data.length;)h.data[o]>200||h.data[o+1]>200||h.data[o+2]>200||(++l,s.r+=h.data[o],s.g+=h.data[o+1],s.b+=h.data[o+2]);return s.r=~~(s.r/l),s.g=~~(s.g/l),s.b=~~(s.b/l),s}static _drawDot(t,e,r,i,n=0,o=1){t.fillRect((e+n)*i,(r+n)*i,o*i,o*i)}static _drawAlignProtector(t,e,r,i){t.clearRect((e-2)*i,(r-2)*i,5*i,5*i),t.fillRect((e-2)*i,(r-2)*i,5*i,5*i)}static _drawAlign(t,e,r,i,n=0,o=1,s,l){const c=t.fillStyle;t.fillStyle=s,new Array(4).fill(0).map((u,h)=>{L._drawDot(t,e-2+h,r-2,i,n,o),L._drawDot(t,e+2,r-2+h,i,n,o),L._drawDot(t,e+2-h,r+2,i,n,o),L._drawDot(t,e-2,r+2-h,i,n,o)}),L._drawDot(t,e,r,i,n,o),l||(t.fillStyle="rgba(255, 255, 255, 0.6)",new Array(2).fill(0).map((u,h)=>{L._drawDot(t,e-1+h,r-1,i,n,o),L._drawDot(t,e+1,r-1+h,i,n,o),L._drawDot(t,e+1-h,r+1,i,n,o),L._drawDot(t,e-1,r+1-h,i,n,o)})),t.fillStyle=c}_draw(){var t,e,r,i,n,o,s,l,c,u,h,b,x,T,E,G,d,p,P;return Ze(this,void 0,void 0,function*(){const g=(t=this.qrCode)===null||t===void 0?void 0:t.moduleCount,w=this.options.size;let m=this.options.margin;(m<0||m*2>=w)&&(m=0);const y=Math.ceil(m),A=w-2*m,k=this.options.whiteMargin,M=this.options.backgroundDimming,f=Math.ceil(A/g),F=f*g,C=F+2*y,N=new rt(C,C),v=N.getContext("2d");this._clear(),v.save(),v.translate(y,y);const lt=new rt(C,C),j=lt.getContext("2d");let Y=null,ot=[];if(this.options.gifBackground){const B=Te(this.options.gifBackground);if(Y=B,ot=Se(B),this.options.autoColor){let D=0,S=0,I=0,H=0;for(let R=0;R<ot[0].colorTable.length;R++){const $=ot[0].colorTable[R];$[0]>200||$[1]>200||$[2]>200||$[0]===0&&$[1]===0&&$[2]===0||(H++,D+=$[0],S+=$[1],I+=$[2])}D=~~(D/H),S=~~(S/H),I=~~(I/H),this.options.colorDark=`rgb(${D},${S},${I})`}}else if(this.options.backgroundImage){const B=yield Kt(this.options.backgroundImage);if(this.options.autoColor){const D=L._getAverageRGB(B);this.options.colorDark=`rgb(${D.r},${D.g},${D.b})`}j.drawImage(B,0,0,B.width,B.height,0,0,C,C),j.rect(0,0,C,C),j.fillStyle=M,j.fill()}else j.rect(0,0,C,C),j.fillStyle=this.options.colorLight,j.fill();const z=_.getPatternPosition(this.qrCode.typeNumber),q=((r=(e=this.options.components)===null||e===void 0?void 0:e.data)===null||r===void 0?void 0:r.scale)||bt,Lt=(1-q)*.5;for(let B=0;B<g;B++)for(let D=0;D<g;D++){const S=this.qrCode.isDark(B,D),I=D<8&&(B<8||B>=g-8)||D>=g-8&&B<8,H=B==6&&D>=8&&D<=g-8||D==6&&B>=8&&B<=g-8;let R=I||H;for(let X=1;X<z.length-1;X++)R=R||B>=z[X]-2&&B<=z[X]+2&&D>=z[X]-2&&D<=z[X]+2;const $=D*f+(R?0:Lt*f),Q=B*f+(R?0:Lt*f);if(v.strokeStyle=S?this.options.colorDark:this.options.colorLight,v.lineWidth=.5,v.fillStyle=S?this.options.colorDark:this.options.colorLight,z.length===0)R||v.fillRect($,Q,(R?1:q)*f,(R?1:q)*f);else{const X=D<g-4&&D>=g-4-5&&B<g-4&&B>=g-4-5;!R&&!X&&v.fillRect($,Q,(R?1:q)*f,(R?1:q)*f)}}const W=z[z.length-1],ee=this.options.colorLight;if(v.fillStyle=ee,v.fillRect(0,0,8*f,8*f),v.fillRect(0,(g-8)*f,8*f,8*f),v.fillRect((g-8)*f,0,8*f,8*f),!((n=(i=this.options.components)===null||i===void 0?void 0:i.timing)===null||n===void 0)&&n.protectors&&(v.fillRect(8*f,6*f,(g-8-8)*f,f),v.fillRect(6*f,8*f,f,(g-8-8)*f)),!((s=(o=this.options.components)===null||o===void 0?void 0:o.cornerAlignment)===null||s===void 0)&&s.protectors&&L._drawAlignProtector(v,W,W,f),!((c=(l=this.options.components)===null||l===void 0?void 0:l.alignment)===null||c===void 0)&&c.protectors)for(let B=0;B<z.length;B++)for(let D=0;D<z.length;D++){const S=z[D],I=z[B];if(!(S===6&&(I===6||I===W))){if(I===6&&(S===6||S===W))continue;if(S===W&&I===W)continue;L._drawAlignProtector(v,S,I,f)}}v.fillStyle=this.options.colorDark,v.fillRect(0,0,7*f,f),v.fillRect((g-7)*f,0,7*f,f),v.fillRect(0,6*f,7*f,f),v.fillRect((g-7)*f,6*f,7*f,f),v.fillRect(0,(g-7)*f,7*f,f),v.fillRect(0,(g-7+6)*f,7*f,f),v.fillRect(0,0,f,7*f),v.fillRect(6*f,0,f,7*f),v.fillRect((g-7)*f,0,f,7*f),v.fillRect((g-7+6)*f,0,f,7*f),v.fillRect(0,(g-7)*f,f,7*f),v.fillRect(6*f,(g-7)*f,f,7*f),v.fillRect(2*f,2*f,3*f,3*f),v.fillRect((g-7+2)*f,2*f,3*f,3*f),v.fillRect(2*f,(g-7+2)*f,3*f,3*f);const Ct=((h=(u=this.options.components)===null||u===void 0?void 0:u.timing)===null||h===void 0?void 0:h.scale)||bt,_t=(1-Ct)*.5;for(let B=0;B<g-8;B+=2)L._drawDot(v,8+B,6,f,_t,Ct),L._drawDot(v,6,8+B,f,_t,Ct);const Mt=((x=(b=this.options.components)===null||b===void 0?void 0:b.cornerAlignment)===null||x===void 0?void 0:x.scale)||bt,re=(1-Mt)*.5;L._drawAlign(v,W,W,f,re,Mt,this.options.colorDark,((E=(T=this.options.components)===null||T===void 0?void 0:T.cornerAlignment)===null||E===void 0?void 0:E.protectors)||!1);const Ft=((d=(G=this.options.components)===null||G===void 0?void 0:G.alignment)===null||d===void 0?void 0:d.scale)||bt,ie=(1-Ft)*.5;for(let B=0;B<z.length;B++)for(let D=0;D<z.length;D++){const S=z[D],I=z[B];if(!(S===6&&(I===6||I===W))){if(I===6&&(S===6||S===W))continue;if(S===W&&I===W)continue;L._drawAlign(v,S,I,f,ie,Ft,this.options.colorDark,((P=(p=this.options.components)===null||p===void 0?void 0:p.alignment)===null||P===void 0?void 0:P.protectors)||!1)}}if(k&&(v.fillStyle=this.options.backgroundColor,v.fillRect(-y,-y,C,y),v.fillRect(-y,F,C,y),v.fillRect(F,-y,y,C),v.fillRect(-y,-y,y,C)),this.options.logoImage){const B=yield Kt(this.options.logoImage);let D=this.options.logoScale,S=this.options.logoMargin,I=this.options.logoCornerRadius;(D<=0||D>=1)&&(D=.2),S<0&&(S=0),I<0&&(I=0);const H=F*D,R=.5*(C-H),$=R;v.restore(),v.fillStyle=this.options.logoBackgroundColor,v.save(),L._prepareRoundedCornerClip(v,R-S,$-S,H+2*S,H+2*S,I+S),v.clip();const Q=v.globalCompositeOperation;v.globalCompositeOperation="destination-out",v.fill(),v.globalCompositeOperation=Q,v.restore(),v.save(),L._prepareRoundedCornerClip(v,R,$,H,H,I),v.clip(),v.drawImage(B,R,$,H,H),v.restore(),v.save(),v.translate(y,y)}if(Y){let B,D,S,I,H,R;if(ot.forEach(function($){B||(B=new O(w,w),B.setDelay($.delay),B.setRepeat(0));const{width:Q,height:X}=$.dims;D||(D=new rt(Q,X),S=D.getContext("2d"),S.rect(0,0,D.width,D.height),S.fillStyle="#ffffff",S.fill()),(!I||!R||Q!==I.width||X!==I.height)&&(I=new rt(Q,X),H=I.getContext("2d"),R=H.createImageData(Q,X)),R.data.set($.patch),H.putImageData(R,0,0),S.drawImage(I.getContext("2d").canvas,$.dims.left,$.dims.top);const dt=new rt(C,C),ht=dt.getContext("2d");ht.drawImage(D.getContext("2d").canvas,0,0,C,C),ht.rect(0,0,C,C),ht.fillStyle=M,ht.fill(),ht.drawImage(N.getContext("2d").canvas,0,0,C,C);const xt=new rt(w,w),Nt=xt.getContext("2d");Nt.drawImage(dt.getContext("2d").canvas,0,0,w,w),B.addFrame(Nt.getImageData(0,0,xt.width,xt.height).data)}),!B)throw new Error("No frames.");if(B.finish(),Xt(this.canvas)){const Q=B.stream().toFlattenUint8Array().reduce((X,dt)=>X+String.fromCharCode(dt),"");return Promise.resolve(`data:image/gif;base64,${window.btoa(Q)}`)}return Promise.resolve(Buffer.from(B.stream().toFlattenUint8Array()))}else{j.drawImage(N.getContext("2d").canvas,0,0,C,C),v.drawImage(lt.getContext("2d").canvas,-y,-y,C,C);const B=new rt(w,w);B.getContext("2d").drawImage(N.getContext("2d").canvas,0,0,w,w),this.canvas=B;const S=this.options.gifBackground?"gif":"png";return Xt(this.canvas)?Promise.resolve(this.canvas.toDataURL(S)):Promise.resolve(this.canvas.toBuffer(S))}})}}L.CorrectLevel=Z;L.defaultComponentOptions={data:{scale:.4},timing:{scale:.5,protectors:!1},alignment:{scale:.5,protectors:!1},cornerAlignment:{scale:.5,protectors:!0}};L.defaultOptions={text:"",size:400,margin:20,colorDark:"#000000",colorLight:"rgba(255, 255, 255, 0.6)",correctLevel:Z.M,backgroundImage:void 0,backgroundDimming:"rgba(0,0,0,0)",logoImage:void 0,logoScale:.2,logoMargin:4,logoCornerRadius:8,whiteMargin:!0,components:L.defaultComponentOptions,autoColor:!0,logoBackgroundColor:"#ffffff",backgroundColor:"#ffffff"};function Xt(a){try{return a instanceof HTMLElement}catch{return typeof a=="object"&&a.nodeType===1&&typeof a.style=="object"&&typeof a.ownerDocument=="object"}}const Je={props:{text:{type:String,required:!0},qid:{type:String},correctLevel:{type:Number,default:1},size:{type:Number,default:200},margin:{type:Number,default:20},colorDark:{type:String,default:"#000000"},colorLight:{type:String,default:"#FFFFFF"},bgSrc:{type:String,default:void 0},background:{type:String,default:"rgba(0,0,0,0)"},backgroundDimming:{type:String,default:"rgba(0,0,0,0)"},logoSrc:{type:String,default:void 0},logoBackgroundColor:{type:String,default:"rgba(255,255,255,1)"},gifBgSrc:{type:String,default:void 0},logoScale:{type:Number,default:.2},logoMargin:{type:Number,default:0},logoCornerRadius:{type:Number,default:8},whiteMargin:{type:[Boolean,String],default:!0},dotScale:{type:Number,default:1},autoColor:{type:[Boolean,String],default:!0},binarize:{type:[Boolean,String],default:!1},binarizeThreshold:{type:Number,default:128},callback:{type:Function,default:function(){}},bindElement:{type:Boolean,default:!0},backgroundColor:{type:String,default:"#FFFFFF"},components:{default:function(){return{data:{scale:1},timing:{scale:1,protectors:!1},alignment:{scale:1,protectors:!1},cornerAlignment:{scale:1,protectors:!0}}}}},name:"vue-qr",data(){return{imgUrl:""}},watch:{$props:{deep:!0,handler(){this.main()}}},mounted(){this.main()},methods:{async main(){if(this.gifBgSrc){const e=await ue(this.gifBgSrc),r=this.logoSrc;this.render(void 0,r,e);return}const a=this.bgSrc,t=this.logoSrc;this.render(a,t)},async render(a,t,e){const r=this;new L({gifBackground:e,text:r.text,size:r.size,margin:r.margin,colorDark:r.colorDark,colorLight:r.colorLight,backgroundColor:r.backgroundColor,backgroundImage:a,backgroundDimming:r.backgroundDimming,logoImage:t,logoScale:r.logoScale,logoBackgroundColor:r.logoBackgroundColor,correctLevel:r.correctLevel,logoMargin:r.logoMargin,logoCornerRadius:r.logoCornerRadius,whiteMargin:Pt(r.whiteMargin),dotScale:r.dotScale,autoColor:Pt(r.autoColor),binarize:Pt(r.binarize),binarizeThreshold:r.binarizeThreshold,components:r.components}).draw().then(i=>{this.imgUrl=i,r.callback&&r.callback(i,r.qid)})}}},Ve=["src"];function We(a,t,e,r,i,n){return e.bindElement?(ce(),se("img",{key:0,style:{display:"inline-block"},src:i.imgUrl},null,8,Ve)):le("",!0)}const tr=fe(Je,[["render",We]]);export{tr as V,fe as _};
